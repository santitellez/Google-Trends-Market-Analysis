---
title: "Google Trends"
author: "Oliver Jin and Santiago Tellez"
date: "2/21/2019"
output: pdf_document
---

```{r, echo=FALSE, warning=FALSE, message=FALSE}
if (!require("pacman")) install.packages("pacman")
pacman::p_load('stringr',
               'knitr',
               'ggplot2',
               'astsa',
               'gtrendsR')
```

```{r, echo=FALSE}
#Loading Bloomberg Data

opts_knit$set(root.dir = normalizePath("../"))

SPX <- read.csv("data/SPX.csv")
VIX <- read.csv("data/VIX.csv")
```

```{r, echo=FALSE}
words <- c("merger")
start_dates <- c(seq.Date(from = as.Date("2004-01-01"), to = as.Date("2019-01-01"), by = "month"))
start_dates <- start_dates[seq(1, length(start_dates), by = 4)]

hits <- list()

for (word in 1:length(words)) {
  search_data <- gtrends(words[word], time = paste(start_dates[1], start_dates[2]))$interest_over_time
  search_data$hits <- gsub("<1", "0.5", search_data$hits)
  search_data$hits <- as.numeric(search_data$hits)
  for (s_date in 2:(length(start_dates) - 1)) {
    time_text = paste(start_dates[s_date], start_dates[s_date + 1])
    temp_data <- gtrends(words[word], time = time_text)$interest_over_time
    temp_data$hits <- gsub("<1", "0.5", temp_data$hits)
    temp_data$hits <- as.numeric(temp_data$hits)
    ratio <-  temp_data$hits[1] / search_data$hits[nrow(search_data)]
    search_data$hits <- search_data$hits * ratio
    search_data <- rbind(search_data, temp_data[-1, ])
  }
  hits[[word]] <- search_data
}

  
```

```{r, echo=FALSE}
#list of 107 words
words <- c("stock", "stock market", "bond", "investment", "invest", "volatility", "gdp", "gnp",
           "sp500", "s&p500", "spx", "vix", "russell2000", "russell1000", "leverage", "growth stock", 
           "interest rate", "interest", "debt", "asset", "liability", "etf", "accounting", "finance", 
           "repayment rate", "money market", "money market", "portfolio", "real estate",
           "recession", "revenue", "cost", "savings", "trade", "treasury bill", "treasury stock",
           "hedge fund", "investment bank", "corporate bank", "commercial bank", "bank",
           "dividend", "taxes", "tax", "inflation", "recession", "risk", "crisis", "mortgage",
           "credit rating", "shares", "cash", "currency", "cash inflow", "cash outflow", "bull market",
           "bear market", "loan", "long term loan", "short term loan", "collateral", "gold", "silver",
           "diamond", "platinum", "bronze", "gold price", "silver price","diamond price", "platinum price",
           "bronze price", "water", "water price", "water bill", "gas", "gas price", 
           "gas station", "electricity", "electricity fee", "electricity bill", "food", "food price",
           "grocery", "grocery price", "microsoft", "microsoft open price", "microsoft close price",
           "apple", "apple open price", "apple close price", "amazon", "amazon open price", 
           "amazon close price", "finance", "refinance", "mortgage loan", "home loan", "house for sale",
           "apartment for sale", "house for rent", "apartment for rent", "house price", "apartment price", 
           "sugar", "sugar price", "salt", "salt price") 
```

